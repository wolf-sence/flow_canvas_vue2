function t(t,e){let i=t.$children,a=t.$uae;for(let t=i.length-1;t>=0;t--)i[t].$vForItem&&i.splice(t,1);let h=e.attrMap["v-for"].split("in "),n=h[0].trim();n.startsWith("(")&&(n=n.substring(1,n.length-1));let o=n.split(",").map((t=>t.trim())),l=new Function("vm",`with(vm) {return vm.${h[1].trim()}}`).call(t,t),r={[o[0]]:null,[o[1]?o[1]:o[1]="_index"]:0};for(;r[o[1]]<l.length;r[o[1]]++){r[o[0]]=l[r[o[1]]];let i=s(r,e,t);a.createNode({type:e.tag,parent:t,vForItem:!0,...i})}}function e(t,e){let i=t.$children,a=t.$uae;for(let t=i.length-1;t>=0;t--)i[t].$vIfItem&&i.splice(t,1);let h=e.attrMap["v-if"];if(new Function("vm",`with(vm) {return vm.${h}}`).call(t,t)){let i=s(t,e,t);a.createNode({type:e.tag,parent:t,vIfItem:!0,...i})}}function i(t,e){let i=t.$children,a=t.$uae;for(let t=i.length-1;t>=0;t--)console.log("进入转换普通子节点",i),i[t].$vIfItem||i[t].$vForItem||i.splice(t,1);let h=s(t,e,t);a.createNode({type:e.tag,parent:t,...h})}function s(t,e,i){console.log("-----重新生成子节点----");let s=e.attrMap,a={};for(let e in s)if(-1===e.indexOf("v-for")&&-1===e.indexOf("v-if")){let h=e;e.startsWith(":")?(h=e.slice(1),a[h]=new Function("obj",`with(obj) {return obj.${s[e]}}`).call(t,t)):e.startsWith("@")?(h=e.slice(1),a[h]=new Function("vm",`with(vm) {return vm.${s[e]}}`).call(i,i)):a[h]=s[h]}return a}function a(t){return null!==t&&"object"==typeof t}function h(t,e){return Object.prototype.hasOwnProperty.call(t,e)}class n{constructor(){}}let o=0;class l{constructor(){this.$id=o++,this.watchs=[]}depend(){l.Target&&l.Target.addDep(this)}removeSub(t){!function(t,e){if(t.length){const i=t.indexOf(e);if(i>-1)t.splice(i,1)}}(this.watchs,t)}addWatch(t){this.watchs.push(t)}notify(){for(let t=0;t<this.watchs.length;t++)this.watchs[t].update()}destroy(){for(let t=this.watchs.length-1;t>=0;t--){this.watchs[t].removeDep(this)}}}function r(t,e){console.warn(`[Flow warn]: ${t}`)}function d(t,e=null){let i=e&&e.config.warning;i&&"function"==typeof i?i.call(null,t):console.error(`[Flow warn]: ${t}`)}function c(){}function u(t,e,i,s){Object.defineProperty(t,e,{value:i,enumerable:s,writable:!0,configurable:!0})}l.Target=null;const g=Array.prototype,f=Object.create(g);function p(t){if(!a(t)||t instanceof n)return;let e=null;return e=h(t,"__fc__")&&t.__fc__ instanceof m?t.__fc__:new m(t),e}["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(t){const e=f[t];u(f,t,(function(...i){const s=e.apply(this,i),a=this.__fc__;let h;switch(t){case"push":case"unshift":h=i;break;case"splice":h=i.slice(2)}return h&&a.observeArray(h),a.dep.notify(),s}))}));class m{constructor(t){var e;this.value=t,this.dep=new l,u(t,"__fc__",this),Array.isArray(t)?(e=f,t.__proto__=e,this.observeArray(t)):this.walk(t)}observeArray(t){for(let e=0;e<t.length;e++)p(t[e])}walk(t){const e=Object.keys(t);for(let i=0;i<e.length;i++)y(t,e[i])}}function y(t,e,i){let s=new l,a=Object.getOwnPropertyDescriptor(t,e);if(a&&!1===a.configurable)return;let h=a&&a.get,n=a&&a.set;h&&!n||2!==arguments.length||(i=t[e]);let o=p(i);p(i),Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){const e=h?h.call(t):i;return l.Target&&s.depend(),o&&(o.dep.depend(),Array.isArray(e)&&x(e)),e},set:function(e){const a=h?h.call(t):i;e===a||e!=e&&a!=a||(n?n.call(i,e):i=e,s.notify())}})}function x(t){for(let e,i=0,s=t.length;i<s;i++)e=t[i],e&&e.__fc__&&e.__fc__.dep.depend(),Array.isArray(e)&&x(e)}let w=0;class b{constructor(t,e,i,s){this.$id=w++,this.vm=t,this.callback=i,s?(this.isFirstRender=!0,this.user=!!s.user,this.before=s.before||"",this.after=s.after||""):this.user=!1,this.deps=[],this.depIds=new Set,this.expOrFn=e,this.active=!0,"function"==typeof e?this.getter=e:(this.getter=function(t){let e=t.split(".");return function(t){try{for(let i=0;i<e.length;i++){if(!t)return;t=t[e[i]]}return t}catch(t){d(`Not found ${e.join(".")} in obj`)}}}(e),this.getter||(this.getter=c)),this.value=this.get()}get(){var t;let e;t=this,l.Target=t;const i=this.vm;try{"function"==typeof this.before&&this.isFirstRender&&this.before.call(i,i),e=this.getter.call(i,i),"function"==typeof this.after&&this.isFirstRender&&this.after.call(i,i),this.isFirstRender=!1}catch(t){if(!this.user)throw t;d(`getter for watcher "${this.expOrFn}" wrong`)}finally{l.Target=null}return e}addDep(t){const e=t.$id;this.depIds.has(e)||(this.depIds.add(e),this.deps.push(t),t.addWatch(this))}depend(){if(l.Target){let t=this.deps.length;for(;t--;)this.deps[t].depend()}}update(){this.run()}run(){if(this.active)try{const t=this.get();if(t!==this.value){const e=this.value;if(this.value=t,this.user)try{this.callback.call(this.vm,t,e)}catch(t){d(`callback for watcher "${this.expOrFn}"`)}else this.callback.call(this.vm,t,e)}}catch(t){throw this.teardown(),t}}teardown(){if(this.active){let t=this.deps.length;for(;t--;)this.deps[t].removeSub(this);this.active=!1}}destroy(){this.teardown();let t=Object.keys(this);for(let e=0;e<t.length;e++)this[t[e]]=null}}let A=0;const v={enumerable:!0,configurable:!0,get:c,set:c};function C(t,e,i){v.get=function(){return this[e][i]},v.set=function(t){this[e][i]=t},Object.defineProperty(t,i,v)}function E(t,e,i){"function"==typeof i?(v.get=k(e),v.set=c):(v.get=k(e),v.set=i.set||c),Object.defineProperty(t,e,v)}function k(t){return function(){const e=this._computedWatchers&&this._computedWatchers[t];return e&&e.depend(),e.value}}function D(t,e,i,s){return a(i)&&(s=i,i=i.handler),t.$watch(e,i,s)}function P(t){this._init_(t)}P.prototype._init_=function(t){const e=this;e.$uid=A++,e.$options=t.options,e.$type=t.type,e.$ctx=e.ctx=t.ctx,e.$uae=e._uae=t.uae,e.$parent=t.parent,e.$children=this.children=[],e._watchers=[],e.$props=e._props={},function(t,e){let i=e.propsData||{},s=e.options.props||[],a=Object.keys(i);for(let e of a)(-1!==s.indexOf(e)||i[e]instanceof Function)&&(t.$props[e]=i[e])}(e,t),function(t){let e=t.$options;e.template&&function(t,e){let i=function(t){t=t||"";for(var e=/^\s*([^\s"'<>/=]+)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,i="[a-zA-Z_][\\-\\.0-9_a-zA-Z"+/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/.source+"]*",s="((?:"+i+"\\:)?"+i+")",a=new RegExp("^<"+s),h=/^\s*(\/?)>/,n=new RegExp("^<\\/"+s+"[^>]*>"),o=0,l=[],r=[];(t=t.trim())&&o++<100;){let i=t.match(a);if(i){let s={tag:i[1],attr:[],attrMap:{},children:[]};var d,c;for(r.push(s),t=t.substring(i[0].length);!(d=t.match(h))&&(c=t.match(e));)s.attr.push({key:c[1],value:c[3]}),s.attrMap[c[1]]=c[3],t=t.substring(c[0].length);d&&(t=t.substring(d[0].length),"/>"===d[0]&&(r.length>1?r[r.length-1].children.push(r.pop()):l.push(r.pop())))}else if(t.match(n))i=t.match(n),t=t.substring(i[0].length),r.length>1?r[r.length-1].children.push(r.pop()):l.push(r.pop());else{let e=t.indexOf("<");t=t.substring(e)}}return l}(e);t.$template=t._template=i}(t,e.template),function(t){let e=t.$props,i=Object.keys(e),s=t.$parent;for(let a=0;a<i.length;a++)"function"==typeof e[i[a]]?t[i[a]]=function(){e[i[a]].apply(s,arguments)}:C(t,"_props",i[a]);p(e)}(t,e.props),function(t,e){"function"==typeof e.beforeCreated&&(t.$beforeCreated=e.beforeCreated),"function"==typeof e.created&&(t.$created=e.created),"function"==typeof e.mounted&&(t.$mounted=e.mounted),"function"==typeof e.beforeDestroy&&(t.$beforeDestroy=e.beforeDestroy),"function"==typeof e.isHere&&(t.$isHere=e.isHere),"function"==typeof e.draw&&(t.$draw=e.draw),"function"==typeof e.hover&&(t.$hover=t.hover=e.hover),"function"==typeof e.click&&(t.$click=t.click=e.click),"function"==typeof e.dblclick&&(t.$dblclick=t.dblclick=e.dblclick),"function"==typeof e.selected&&(t.$selected=t.selected=e.selected),"function"==typeof e.mousedown&&(t.$mousedown=t.mousedown=e.mousedown),"function"==typeof e.mouseup&&(t.$mouseup=t.mouseup=e.mouseup)}(t,e),t.$beforeCreated&&t.$beforeCreated(),e.methods&&function(t,e){let i=t.$options.props;for(let s in e)"function"!=typeof e[s]&&r(`Methods [${s}] isn't function`),i&&h(i,s)&&r(`Methods [${s}] has already defined as a prop`),s in t&&r(`Methods [${s}] already existing`),t[s]="function"!=typeof e[s]?c:e[s]}(t,e.methods),e.data&&function(t){let e=t.$options.data;e=t._data="function"==typeof e?e.call(t,t):e||{};let i=Object.keys(e);const s=t.$options.props,a=t.$options.methods;for(let e=0;e<i.length;e++)a&&h(a,i[e])&&r(`data [${key}] has already defined as a methods`),s&&h(s,i[e])?r(`data [${key}] has already defined as a prop`):C(t,"_data",i[e]);p(e)}(t),e.computed&&function(t,e){const i=t._computedWatchers=Object.create(null);for(let s in e){const a=e[s],h="function"==typeof a?a:a.get;i[s]=new b(t,h||c,c),s in t?r(`the computed property "${s}" is already defined`):E(t,s,a)}for(let e in i)t._watchers.push(i[e])}(t,e.computed),e.watch&&function(t,e){for(let i in e)D(t,i,e[i])}(t,e.watch),t.$created&&t.$created()}(e)},function(t){t.prototype.$watch=function(t,e,i){let s=this;if(a(e))return D(s,t,e,i);(i=i||{}).user=!0;let h=new b(s,t,e,i);s._watchers.push(h)},t.prototype.$on=function(t,e){"function"==typeof e&&(this.events||(this.events={}),this.events[t]||(this.events[t]=[]),this.events[t].push(e))},t.prototype.$off=function(t,e){"function"==typeof e&&(this.events||(this.events={}),this.events[t]||(this.events[t]=[]),this.events[t].splice(this.events[t].indexOf(e),1))},t.prototype.$emit=function(t,...e){this.events&&this.events[t]&&this.events[t].forEach((t=>{"function"==typeof t&&t.call(this.$parent,...e)}))}}(P);let Y=class{constructor(){this.grid=new Map,this.rate=5}checkPoint(t,e){let i=this.getRoundVal(t),s=this.getRoundVal(e);if(this.grid.has(i)){let t=this.grid.get(i).get(s);return t&&t.split(",")}}checkRange(t,e,i,s){t=this.getRoundVal(t),i=this.getRoundVal(i),e=this.getRoundVal(e),s=this.getRoundVal(s);let a=[];for(let h=t;h<=i;h++)if(this.grid.has(h))for(let t=e;t<=s;t++){let e=this.grid.get(h).get(t);e&&e.split(",").forEach((t=>{-1===a.indexOf(t)&&a.push(t)}))}return a}loopAllNodes(t){this.clearGrid();for(let e=0;e<t.length;e++){let i=t[e];i.$block&&this.handleUpdate(i)}}handleDelete(t){let e=t=>{for(let i=0;i<t.length;i++){let s=t[i];if(!s.$block)return;let a=this.getRateBound(s.bounds);this.delete(a.xs,a.ys,a.xe,a.ye,s.$uid),s.$children&&s.$children.length>0&&e(s.$children)}};t.$block&&e([t])}handleUpdate(t){let e=t=>{for(let i=0;i<t.length;i++){let s=t[i];if(!s.$block)return;let a=this.getRateBound(s.bounds);a.xs===a.xe&&a.xe++,a.ys===a.ye&&a.ye++,this.create(a.xs,a.ys,a.xe,a.ye,s.$uid),s.$children&&s.$children.length>0&&e(s.$children)}};t.$block&&e([t])}delete(t,e,i,s,a){let h,n=this.grid;for(let o=t;o<=i;o++){h=n.get(o);for(let t=e;t<=s;t++){let e=h&&h.get(t);if(e){let i=e.split(","),s=i.indexOf(""+a);-1!==s&&i.splice(s,1),0===i.length?h.delete(t):h.set(t,i.join(","))}}h&&0!==h.size||n.delete(o),h=null}}create(t,e,i,s,a){let h,n=this.grid;for(let o=t;o<=i;o++){n.has(o)?h=n.get(o):(h=new Map,n.set(o,h));for(let t=e;t<=s;t++)if(h.has(t)){let e=h.get(t).split(",");e.push(a),h.set(t,e.join(","))}else h.set(t,`${a}`)}}clearGrid(){this.grid=new Map}getRateBound(t){return{xs:this.getMinVal(t.x),ys:this.getMinVal(t.y),xe:this.getMaxVal(t.x+t.width),ye:this.getMaxVal(t.y+t.height)}}getMinVal(t){return Math.floor(t/this.rate)}getMaxVal(t){return Math.ceil(t/this.rate)}getRoundVal(t){return Math.round(t/this.rate)}};Y.getInstance=function(){let t=null;return function(){return t||(t=new Y),t}}();let B=Y.getInstance();function M(t=!0){let e=this.$parent,i=this.$uae;this.$block&&B.handleDelete(this),console.log("销毁中",t);for(let e=0;e<this.$children.length;e++)this.$children[e].$destroy(t),e--;if(t){if(!1===(this.$beforeDestroy&&this.$beforeDestroy()))return}delete i._nodeMap[this.$uid];for(let t=0;t<i.$children.length;t++){let e=i.$children[t];if(this.$uid===e.$uid){i.$children.splice(t,1);break}}for(let t=0;t<e.$children.length;t++){let i=e.$children[t];if(this.$uid===i.$uid){e.$children.splice(t,1);break}}let s=Object.keys(this),a=this._watchers;for(let t=0;t<s.length;t++)try{s[t]in this&&this[s[t]]&&delete this[s[t]]}catch(t){}for(let t=0;t<a.length;t++)a[t].destroy();a=null}function S(t,e){this._distance.dx=t-this.bounds.x,this._distance.dy=e-this.bounds.y,this.recordDragStart()}function I(t,e){let i=t-this._distance.dx,s=e-this._distance.dy;this.isBorderX(i)||(this.data.bounds.x=i),this.isBorderY(s)||(this.data.bounds.y=s)}function T(t,e){let i=t-this._distance.dx,s=e-this._distance.dy;this.isBorderX(i)||(this.data.bounds.x=i),this.isBorderY(s)||(this.data.bounds.y=s),this.recordDragEnd()}class Q extends P{constructor(t){super(t);const e=this,i=e.$options;e.$vIfItem=t.vIfItem,e.$vForItem=t.vForItem,e.$dragable=e.dragable=!("dragable"in i)||i.dragable,e.$cursor=i.cursor||"pointer",e.$block=!("block"in i)||i.block,e.$link=!("link"in i)||i.link,e._distance={dx:null,dy:null},B.handleUpdate(e),this._init(e),e.$render();const s=setTimeout((()=>{e.$mounted&&e.$mounted(),clearTimeout(s)}),0)}_init(s){!function(t){t.render=t.$render=()=>{let e={after:()=>{t.$draw&&t.$draw()}},i=new b(t,(()=>{t.$uae&&t.$uae.draw()}),null,e);t._watchers.push(i)}}(s),function(t){let e=t.$options;t.dragable&&("function"==typeof e.dragstart?t.$dragstart=t.dragstart=e.dragstart:t.$dragstart=t.dragstart=(e,i)=>{S.call(t,e,i)},"function"==typeof e.drag?t.$drag=t.drag=e.drag:t.$drag=t.drag=(e,i)=>{I.call(t,e,i)},"function"==typeof e.dragend?t.$dragend=t.dragend=e.dragend:t.$dragend=t.dragend=(e,i)=>{T.call(t,e,i)})}(s),s.$destroy=(...t)=>{M.apply(s,t)},function(s){if(s.$template)for(let a=0;a<s.$template.length;a++){let h=s.$template[a];if(h.attrMap["v-if"]&&h.attrMap["v-for"])errorTip("we're not support v-for and v-if been use in same component!");else if(h.attrMap["v-if"]){let t=new b(s,(()=>{e(s,h)}));s._watchers.push(t)}else if(h.attrMap["v-for"]){let e=new b(s,(()=>{t(s,h)}));s._watchers.push(e)}else{let t=new b(s,(()=>{i(s,h)}));s._watchers.push(t)}}}(s)}recordDragStart(){B.handleDelete(this)}recordDragEnd(){B.handleUpdate(this)}isBorderX(t){let e=Number(this.$uae.canvas.style.width.slice(0,-2));return t<2||t>e-this.bounds.width-8}isBorderY(t){let e=Number(this.$uae.canvas.style.height.slice(0,-2));return t<2||t>e-this.bounds.height-8}}function F(t,e=[]){if(null===t||"object"!=typeof t)return t;const i=e.filter((e=>e.original===t))[0];if(i)return i.copy;const s=Array.isArray(t)?[]:{};return e.push({original:t,copy:s}),Object.keys(t).forEach((i=>{s[i]=F(t[i],e)})),s}class O{constructor(){this.list=[],this.map={}}pushData(t){this.list.push(t),this.map[t.id]=t}pushDatas(t){if(Array.isArray){this.list=t;for(let e=0;e<t.length;e++){let i=t[e];this.map[i.id]=i}}}delData(t){-1!==this.list.indexOf(t)&&(this.list.splice(this.list.indexOf(t),1),delete this.map[t.id])}delDatas(t){t.forEach((t=>{-1!==this.list.indexOf(t)&&(this.list.splice(this.list.indexOf(t),1),delete this.map[t.id])}))}getDataById(t){return this.map[t]}}O.getInstance=function(){let t=null;return function(){return t||(t=new O),t}}();class N{constructor(t){this.uae=t,this.stack=[]}drillUae(t){let e=this.uae.$children,i=[];for(let t=e.length-1;t>=0;t--){let s=e[t];s.$block&&(i.push(s.data),s.$destroy(!1))}this.uae.historys.clearHistory(),this.uae.Grid.clearGrid(),this.stack.push(i),this.uae.isNode=!0,this.uae.loopNodeList(t),this.uae.repaint()}popUae(){if(this.stack.length>0){let t=this.uae.$children;for(let e=t.length-1;e>=0;e--){let i=t[e];i.$block&&i.$destroy(!1)}this.uae.historys.clearHistory();let e=this.stack.pop();this.uae.loopNodeList(e),this.uae.repaint()}0===this.stack.length&&(this.uae.isNode=!1)}clearNodeMap(t){let e=this.uae._nodeMap;for(let i=0;i<t.length;i++)delete e[t[i].$uid],t[i].$children&&t[i].$children.length>0&&this.clearNodeMap(t[i].$children)}setNodeMap(t){let e=this.uae._nodeMap;for(let i=0;i<t.length;i++)e[t[i].$uid]=t[i],t[i].$children&&t[i].$children.length>0&&this.setNodeMap(t[i].$children)}}class ${constructor(t){this.historyLow=-1,this.historyHigh=-1,this.historys=[],this.uae=t}restore(){if(this.historyLow>=0){let t=this.historys[this.historyLow--];switch(t.type){case"create":this.restoreCreate(t.data);break;case"delete":this.restoreDelete(t.list);break;case"move":this.restoreMove(t.list)}}}forward(){this.historyLow,this.historyHigh}recordCreate(t){this.historys[++this.historyLow]={type:"create",data:t},this.historyHigh=this.historyLow}recordDelete(t){let e={type:"delete",list:[]};this.historyLow++;for(let i=0;i<t.length;i++){let s=this.uae._nodeMap[t[i]];"edge"!==s.$type&&e.list.push({data:s.data})}this.historys[this.historyLow]=e,this.historyHigh=this.historyLow}recordMove(t){let e={type:"move",list:[]};for(let i=0;i<t.length;i++){let s=this.uae._nodeMap[t[i]];s.$block&&e.list.push({data:s.data,origin:{x:s.bounds.x,y:s.bounds.y}})}e.list.length>0&&(this.historys[++this.historyLow]=e,this.historyHigh=this.historyLow)}restoreCreate(t){for(let e=0;e<this.uae.$children.length;e++)if(this.uae.$children[e].data===t){this.uae.$children[e].$destroy();break}}restoreMove(t){for(let e=0;e<t.length;e++){let i=t[e].data,s=t[e].origin;for(let t=0;t<this.uae.$children.length;t++)if(this.uae.$children[t].data===i){let e=this.uae.$children[t];e.recordDragStart(),i.bounds.x=s.x,i.bounds.y=s.y,e.recordDragEnd();break}}}restoreDelete(t){for(let e=0;e<t.length;e++){let i=t[e].data;this.uae.createNode({type:i.nodeType,data:i})}}clearHistory(){this.historyHigh=-1,this.historyLow=-1,this.historys=[]}}let R=Y.getInstance();let H=class extends P{constructor(t){super(t),this.$templateClass={},this._nodeMap={},this._drawing=!1,this.sc=1,this.ratio=t.ratio||1,this.tx=0,this.ty=0,this.$canvas=this.canvas=t.options.canvas,this.$ctx=this.ctx=this.$canvas.getContext("2d"),this.RS=new L(this),this.selecteds=[],this.dockeydown=null,this._init(t),this.Grid=R,this.flowData=O.getInstance(),this.drill=new N(this),this.historys=new $(this),this.$mounted&&this.$mounted()}registerComp(t){let e=t.name,i=t.mixin,s=t;i&&(this.$templateClass[i]?s=this.$templateClass[i]&&this.mixinComp(t,this.$templateClass[i]):d(`we cann't find mixin-template: ${i} when we're trying to register ${e}`)),this.$templateClass[e]=s}mixinComp(t,e){if(e.mixin){let t=e.mixin;t&&(this.$templateClass[t]?e=this.$templateClass[t]&&this.mixinComp(e,this.$templateClass[t]):d(`we cann't find mixin-template: ${t} when we're trying to register ${e.name}`))}let i=Object.assign({},e,t);return i.data=Object.assign({},(e||{}).data||{},(t||{}).data||{}),i.methods=Object.assign({},(e||{}).methods||{},(t||{}).methods||{}),i.watch=Object.assign({},(e||{}).watch||{},(t||{}).watch||{}),i.computed=Object.assign({},(e||{}).computed||{},(t||{}).computed||{}),i.props=[].concat((e||{}).props||[]).concat(t.props||[]),i}loopNodeList(t){this.flowData.pushDatas(t);for(let e=0;e<t.length;e++){let i=t[e];this.createNode({type:i.nodeType,data:i})}}createNode(t,e=!1){let{type:i,parent:s,vForItem:a,vIfItem:h,...n}=t,o=this.getTemplate(i),l=new Q({options:o,type:i,propsData:n,ctx:this.$ctx,uae:this,parent:s||this,vForItem:a,vIfItem:h});return(s?s.$children:this.$children).push(l),this._nodeMap[l.$uid]=l,e&&this.historys.recordCreate(n),l}getTemplate(t){return this.$templateClass[t]?F(this.$templateClass[t]):(d(`error: we cann't find tempalte ${t}`),{})}_init(t){this.ratio=function(t){let e=t.$canvas,i=t.$ctx,s=(window.devicePixelRatio||1)/(i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1);return e.style.width=e.width+"px",e.style.height=e.height+"px",e.width=e.width*s,e.height=e.height*s,i.scale(s,s),s}(this),this._bind(),this.ctx.roundRect=function(t,e,i,s,a){let h=this;h.moveTo(t+a,e),h.lineTo(t+i-a,e),a&&h.arcTo(t+i,e,t+i,e+a,a),h.lineTo(t+i,e+s-a),a&&h.arcTo(t+i,e+s,t+i-a,e+s,a),h.lineTo(t+a,e+s),a&&h.arcTo(t,e+s,t,e+s-a,a),h.lineTo(t,e+a),a&&h.arcTo(t,e,t+a,e,a)}}_bind(){let t,e=this.$canvas;e.addEventListener("click",(t=>{let e=t.offsetX,i=t.offsetY,s=this._toCanvasX(t.offsetX),a=this._toCanvasY(t.offsetY),h=this.getCompByPoint(e,i,s,a);this.$emit("click",{e:t,x:this._toCanvasX(e),y:this._toCanvasY(i),comp:h})})),e.addEventListener("dblclick",(t=>{let e=t.offsetX,i=t.offsetY,s=this._toCanvasX(t.offsetX),a=this._toCanvasY(t.offsetY),h=this.getCompByPoint(e,i,s,a);h&&h.$dblclick&&h.$dblclick(s,a),this.$emit("dblclick",{e:t,x:this._toCanvasX(e),y:this._toCanvasY(i),comp:h})})),e.addEventListener("mousemove",(t=>{let i=t.offsetX,s=t.offsetY,a=this._toCanvasX(t.offsetX),h=this._toCanvasY(t.offsetY),n=this.getCompByPoint(i,s,a,h);n?(e.style.cursor=n.$cursor,n.$hover&&n.$hover(!0),this.clearHover([n.$uid])):(this.clearHover(),e.style.cursor="default"),this.$emit("mousemove",{e:t,x:a,y:h,comp:n})})),e.addEventListener("mousedown",(t=>{let i=this._toCanvasX(t.offsetX),s=this._toCanvasY(t.offsetY),a=!1,h=this.getCompByPoint(t.offsetX,t.offsetY,i,s,!1),n=t=>{let n=this._toCanvasX(t.offsetX),o=this._toCanvasY(t.offsetY),l=n-i,r=o-s;if(!l&&!r)return;if(!a){a=!0,this.selecteds.length>0&&(this.selecteds.forEach((t=>{this._nodeMap[t].$dragstart&&this._nodeMap[t].$dragstart(n,o)})),this.selecteds.length>0&&this.historys.recordMove(this.selecteds));let e={e:t,x:i,y:s,comp:h};this.$emit("dragstart",e)}this.selecteds.length>0&&(e.style.cursor="pointer",this.selecteds.forEach((t=>{this._nodeMap[t].$drag&&this._nodeMap[t].$drag(n,o)})));let d={e:t,x:n,y:o,comp:h,dx:l,dy:r};this.$emit("drag",d)},o=t=>{e.removeEventListener("mousemove",n),e.removeEventListener("mouseup",o),e.removeEventListener("mouseleave",o);let h=this._toCanvasX(t.offsetX),l=this._toCanvasY(t.offsetY),r=h-i,d=l-s;if(a){this.selecteds.length>0&&this.selecteds.forEach((t=>{this._nodeMap[t].$dragend&&this._nodeMap[t].$dragend(h,l),this._nodeMap[t].$mouseup&&this._nodeMap[t].$mouseup()}));let e={e:t,x:h,y:l,dx:r,dy:d};this.$emit("dragend",e)}};h&&-1===this.selecteds.indexOf(h.$uid)?this.clearSelected([h.$uid]):h||this.clearSelected(),h&&h.$mousedown&&h.$mousedown(),e.addEventListener("mousemove",n),e.addEventListener("mouseup",o),e.addEventListener("mouseleave",o)})),e.addEventListener("mouseup",(t=>{this.$emit("mouseup",{e:t,x:this._toCanvasX(t.offsetX),y:this._toCanvasY(t.offsetY)})})),e.addEventListener("mouseenter",(t=>{this.$emit("mouseenter",{e:t,x:this._toCanvasX(t.offsetX),y:this._toCanvasY(t.offsetY)})})),e.addEventListener("mouseleave",(t=>{this.$emit("mouseleave",{e:t,x:this._toCanvasX(t.offsetX),y:this._toCanvasY(t.offsetY)})})),e.addEventListener("contextmenu",(t=>{let e=this._toCanvasX(t.offsetX),i=this._toCanvasY(t.offsetY),s=this.getCompByPoint(t.offsetX,t.offsetY,e,i);s&&s.$contextmenu&&s.$contextmenu(),this.$emit("contextmenu",{e:t,x:e,y:i,comp:s})})),document.addEventListener("keydown",this.dockeydown=e=>{if(90==e.keyCode&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey))this.historys.restore();else if(89==e.keyCode&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey));else if(46==e.keyCode)this.deleteSelected();else if(65==e.keyCode&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)){let t=[];this.$children.forEach((e=>{e.$block&&t.push(e.$uid)})),this.clearSelected(t),e.preventDefault()}else if(67==e.keyCode&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey))t=this.selecteds,console.log("copyNodeids",t);else if(86==e.keyCode&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)){if(t){let e=[];t.forEach((t=>{let i=F(this._nodeMap[t].data);i.bounds.x+=20,i.bounds.x+=20,e.push(i)})),this.loopNodeList(e)}t=null}})}draw(){if(this._drawing)return;this._drawing=!0;let t=function(e){for(let i,s=0;e.length,i=e[s];s++)i.$draw&&i.$draw(),i.$children&&i.$children.length>0&&t(i.$children)},e=setTimeout((()=>{clearTimeout(e),this._drawing=!1;let i=this.RS.getSequence();this.ctx.clearRect(0,0,this.$canvas.width,this.$canvas.height),this._renderBg(),t(i)}),10)}getCompByPoint(t,e,i,s,a=!0){let h=R.checkPoint(i,s);if(h&&Array.isArray(h))return this._nodeMap[h.slice(-1)];if(h)return this._nodeMap[h];{let i=t*this.ratio,s=e*this.ratio;return this.getEdgeByPoint(i,s)}}getEdgeByPoint(t,e){let i=function(s){for(let a,h=0;s.length,a=s[h];h++){if(a.$children&&a.$block){let e=i(t);if(e)return e}if(a.$isHere&&a.$isHere(t,e))return a}};for(let s in this._nodeMap){let a=this._nodeMap[s];if(!a.$block&&a.$isHere){if(a.$children&&a.$children.length>0){let t=i(a.$children);if(t)return t}if(a.$isHere(t,e))return a}}}getChildByRange(t,e,i,s){let a=this.Grid.checkRange(t,e,i,s),h=this.$children.filter((t=>a.indexOf(""+t.$uid)>-1));return this.selecteds=h.map((t=>t.$uid)),h}deleteSelected(){this.historys.recordDelete(this.selecteds),this.selecteds.forEach((t=>{let e=this._nodeMap[t];this.flowData.delData(e.data),e.$destroy()})),this.selecteds=[],this.repaint()}clearHover(t=[]){this.$children.forEach((e=>{-1===t.indexOf(e.$uid)&&e.$hover&&e.$hover(!1)}));for(let e in this._nodeMap){let i=this._nodeMap[e];"edge"===i.$type&&-1===t.indexOf(i.$uid)&&i.$hover&&i.$hover(!1)}}clearSelected(t=[]){this.$children.forEach((e=>{-1===t.indexOf(e.$uid)?e.$click&&e.$click(!1):e.$click&&e.$click(!0)}));for(let e in this._nodeMap){let i=this._nodeMap[e];!i.$block&&i.$isHere&&-1===t.indexOf(i.$uid)?i.$click&&i.$click(!1):!i.$block&&i.$isHere&&i.$click&&i.$click(!0)}this.selecteds=t}repaint(){this.draw()}scale(t){this.ctx.scale(t,t),this.repaint(),this.sc=this.sc*t}translate(t,e){this.ctx.translate(t,e),this.tx=t,this.ty=e,this.repaint()}translateX(t){this.ctx.translate(t,0),this.tx=t,this.repaint()}translateY(t){this.ctx.translate(0,t),this.ty=t,this.repaint()}_getWidth(){return this.canvas.width/this.ratio}_getHeight(){return this.canvas.height/this.ratio}_toCanvasX(t){return t/this.sc-this.tx}_toCanvasY(t){return t/this.sc-this.ty}_renderBg(){if(this.isRenderBg){let t=this.ctx;t.beginPath();let e=this.$canvas.width,i=this.$canvas.height,s=10;t.lineWidth=1;for(let a=.5;a<e;a+=s)t.moveTo(a,0),t.lineTo(a,i);for(let a=.5;a<i;a+=s)t.moveTo(0,a),t.lineTo(e,a);t.strokeStyle="#eee",t.stroke(),this.ctx.closePath()}}};class L{constructor(t){this.uae=t,this.$children=t.$children,this._nodeMap=t._nodeMap,this.sequence=[],this.initSeq()}initSeq(){this.sequence=this.$children.map((t=>t.id))}getSequence(){let t=this.getSelect(),e=this.getHover();return this.$children.filter((i=>-1===t.indexOf(i)&&-1===e.indexOf(i))).concat(e,t)}getSelect(){let t=[],e=this._nodeMap;return Object.keys(e).forEach((i=>{e[i].isSelect&&t.push(this._findParent(e[i]))})),t}getHover(){let t=[],e=this._nodeMap;return Object.keys(e).forEach((i=>{e[i].isHover&&t.push(this._findParent(e[i]))})),t}_findParent(t){return t.$parent instanceof H?t:t.$parent?this._findParent(t.$parent):null}}let j=Y.getInstance();class X extends P{constructor(t){super(t),this.$templateClass={},this._nodeMap={},this._drawing=!1,this.sc=1,this.ratio=t.ratio||1,this.tx=0,this.ty=0,this.$canvas=this.canvas=t.options.canvas,this.$ctx=this.ctx=this.$canvas.getContext("2d"),this.RS=new L(this),this.selecteds=[],this.dockeydown=null,this._init(t),this.Grid=j,this.flowData=O.getInstance(),this.drill=new N(this),this.historys=new $(this),this.$mounted&&this.$mounted()}registerComp(t){let e=t.name,i=t.mixin,s=t;i&&(this.$templateClass[i]?s=this.$templateClass[i]&&this.mixinComp(t,this.$templateClass[i]):d(`we cann't find mixin-template: ${i} when we're trying to register ${e}`)),this.$templateClass[e]=s}mixinComp(t,e){if(e.mixin){let t=e.mixin;t&&(this.$templateClass[t]?e=this.$templateClass[t]&&this.mixinComp(e,this.$templateClass[t]):d(`we cann't find mixin-template: ${t} when we're trying to register ${e.name}`))}let i=Object.assign({},e,t);return i.data=Object.assign({},(e||{}).data||{},(t||{}).data||{}),i.methods=Object.assign({},(e||{}).methods||{},(t||{}).methods||{}),i.watch=Object.assign({},(e||{}).watch||{},(t||{}).watch||{}),i.computed=Object.assign({},(e||{}).computed||{},(t||{}).computed||{}),i.props=[].concat((e||{}).props||[]).concat(t.props||[]),i}loopNodeList(t){this.flowData.pushDatas(t);for(let e=0;e<t.length;e++){let i=t[e];this.createNode({type:i.nodeType,data:i})}}createNode(t,e=!1){let{type:i,parent:s,vForItem:a,vIfItem:h,...n}=t,o=this.getTemplate(i),l=new Q({options:o,type:i,propsData:n,ctx:this.$ctx,uae:this,parent:s||this,vForItem:a,vIfItem:h});return(s?s.$children:this.$children).push(l),this._nodeMap[l.$uid]=l,e&&this.historys.recordCreate(n),l}getTemplate(t){return this.$templateClass[t]?F(this.$templateClass[t]):(d(`error: we cann't find tempalte ${t}`),{})}_init(t){this.ratio=function(t){let e=t.$canvas,i=t.$ctx,s=(window.devicePixelRatio||1)/(i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1);return e.style.width=e.width+"px",e.style.height=e.height+"px",e.width=e.width*s,e.height=e.height*s,i.scale(s,s),s}(this),this._bind(),this.ctx.roundRect=function(t,e,i,s,a){let h=this;h.moveTo(t+a,e),h.lineTo(t+i-a,e),a&&h.arcTo(t+i,e,t+i,e+a,a),h.lineTo(t+i,e+s-a),a&&h.arcTo(t+i,e+s,t+i-a,e+s,a),h.lineTo(t+a,e+s),a&&h.arcTo(t,e+s,t,e+s-a,a),h.lineTo(t,e+a),a&&h.arcTo(t,e,t+a,e,a)}}_bind(){let t,e=this.$canvas;e.addEventListener("click",(t=>{let e=t.offsetX,i=t.offsetY,s=this._toCanvasX(t.offsetX),a=this._toCanvasY(t.offsetY),h=this.getCompByPoint(e,i,s,a);this.$emit("click",{e:t,x:this._toCanvasX(e),y:this._toCanvasY(i),comp:h})})),e.addEventListener("dblclick",(t=>{let e=t.offsetX,i=t.offsetY,s=this._toCanvasX(t.offsetX),a=this._toCanvasY(t.offsetY),h=this.getCompByPoint(e,i,s,a);h&&h.$dblclick&&h.$dblclick(s,a),this.$emit("dblclick",{e:t,x:this._toCanvasX(e),y:this._toCanvasY(i),comp:h})})),e.addEventListener("mousemove",(t=>{let i=t.offsetX,s=t.offsetY,a=this._toCanvasX(t.offsetX),h=this._toCanvasY(t.offsetY),n=this.getCompByPoint(i,s,a,h);n?(e.style.cursor=n.$cursor,n.$hover&&n.$hover(!0),this.clearHover([n.$uid])):(this.clearHover(),e.style.cursor="default"),this.$emit("mousemove",{e:t,x:a,y:h,comp:n})})),e.addEventListener("mousedown",(t=>{let i=this._toCanvasX(t.offsetX),s=this._toCanvasY(t.offsetY),a=!1,h=this.getCompByPoint(t.offsetX,t.offsetY,i,s,!1),n=t=>{let n=this._toCanvasX(t.offsetX),o=this._toCanvasY(t.offsetY),l=n-i,r=o-s;if(!l&&!r)return;if(!a){a=!0,this.selecteds.length>0&&(this.selecteds.forEach((t=>{this._nodeMap[t].$dragstart&&this._nodeMap[t].$dragstart(n,o)})),this.selecteds.length>0&&this.historys.recordMove(this.selecteds));let e={e:t,x:i,y:s,comp:h};this.$emit("dragstart",e)}this.selecteds.length>0&&(e.style.cursor="pointer",this.selecteds.forEach((t=>{this._nodeMap[t].$drag&&this._nodeMap[t].$drag(n,o)})));let d={e:t,x:n,y:o,comp:h,dx:l,dy:r};this.$emit("drag",d)},o=t=>{e.removeEventListener("mousemove",n),e.removeEventListener("mouseup",o),e.removeEventListener("mouseleave",o);let h=this._toCanvasX(t.offsetX),l=this._toCanvasY(t.offsetY),r=h-i,d=l-s;if(a){this.selecteds.length>0&&this.selecteds.forEach((t=>{this._nodeMap[t].$dragend&&this._nodeMap[t].$dragend(h,l),this._nodeMap[t].$mouseup&&this._nodeMap[t].$mouseup()}));let e={e:t,x:h,y:l,dx:r,dy:d};this.$emit("dragend",e)}};h&&-1===this.selecteds.indexOf(h.$uid)?this.clearSelected([h.$uid]):h||this.clearSelected(),h&&h.$mousedown&&h.$mousedown(),e.addEventListener("mousemove",n),e.addEventListener("mouseup",o),e.addEventListener("mouseleave",o)})),e.addEventListener("mouseup",(t=>{this.$emit("mouseup",{e:t,x:this._toCanvasX(t.offsetX),y:this._toCanvasY(t.offsetY)})})),e.addEventListener("mouseenter",(t=>{this.$emit("mouseenter",{e:t,x:this._toCanvasX(t.offsetX),y:this._toCanvasY(t.offsetY)})})),e.addEventListener("mouseleave",(t=>{this.$emit("mouseleave",{e:t,x:this._toCanvasX(t.offsetX),y:this._toCanvasY(t.offsetY)})})),e.addEventListener("contextmenu",(t=>{let e=this._toCanvasX(t.offsetX),i=this._toCanvasY(t.offsetY),s=this.getCompByPoint(t.offsetX,t.offsetY,e,i);s&&s.$contextmenu&&s.$contextmenu(),this.$emit("contextmenu",{e:t,x:e,y:i,comp:s})})),document.addEventListener("keydown",this.dockeydown=e=>{if(90==e.keyCode&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey))this.historys.restore();else if(89==e.keyCode&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey));else if(46==e.keyCode)this.deleteSelected();else if(65==e.keyCode&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)){let t=[];this.$children.forEach((e=>{e.$block&&t.push(e.$uid)})),this.clearSelected(t),e.preventDefault()}else if(67==e.keyCode&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey))t=this.selecteds,console.log("copyNodeids",t);else if(86==e.keyCode&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)){if(t){let e=[];t.forEach((t=>{let i=F(this._nodeMap[t].data);i.bounds.x+=20,i.bounds.x+=20,e.push(i)})),this.loopNodeList(e)}t=null}})}draw(){if(this._drawing)return;this._drawing=!0;let t=function(e){for(let i,s=0;e.length,i=e[s];s++)i.$draw&&i.$draw(),i.$children&&i.$children.length>0&&t(i.$children)},e=setTimeout((()=>{clearTimeout(e),this._drawing=!1;let i=this.RS.getSequence();this.ctx.clearRect(0,0,this.$canvas.width,this.$canvas.height),this._renderBg(),t(i)}),10)}getCompByPoint(t,e,i,s,a=!0){let h=j.checkPoint(i,s);if(h&&Array.isArray(h))return this._nodeMap[h.slice(-1)];if(h)return this._nodeMap[h];{let i=t*this.ratio,s=e*this.ratio;return this.getEdgeByPoint(i,s)}}getEdgeByPoint(t,e){let i=function(s){for(let a,h=0;s.length,a=s[h];h++){if(a.$children&&a.$block){let e=i(t);if(e)return e}if(a.$isHere&&a.$isHere(t,e))return a}};for(let s in this._nodeMap){let a=this._nodeMap[s];if(!a.$block&&a.$isHere){if(a.$children&&a.$children.length>0){let t=i(a.$children);if(t)return t}if(a.$isHere(t,e))return a}}}getChildByRange(t,e,i,s){let a=this.Grid.checkRange(t,e,i,s),h=this.$children.filter((t=>a.indexOf(""+t.$uid)>-1));return this.selecteds=h.map((t=>t.$uid)),h}deleteSelected(){this.historys.recordDelete(this.selecteds),this.selecteds.forEach((t=>{let e=this._nodeMap[t];this.flowData.delData(e.data),e.$destroy()})),this.selecteds=[],this.repaint()}clearHover(t=[]){this.$children.forEach((e=>{-1===t.indexOf(e.$uid)&&e.$hover&&e.$hover(!1)}));for(let e in this._nodeMap){let i=this._nodeMap[e];"edge"===i.$type&&-1===t.indexOf(i.$uid)&&i.$hover&&i.$hover(!1)}}clearSelected(t=[]){this.$children.forEach((e=>{-1===t.indexOf(e.$uid)?e.$click&&e.$click(!1):e.$click&&e.$click(!0)}));for(let e in this._nodeMap){let i=this._nodeMap[e];!i.$block&&i.$isHere&&-1===t.indexOf(i.$uid)?i.$click&&i.$click(!1):!i.$block&&i.$isHere&&i.$click&&i.$click(!0)}this.selecteds=t}repaint(){this.draw()}scale(t){this.ctx.scale(t,t),this.repaint(),this.sc=this.sc*t}translate(t,e){this.ctx.translate(t,e),this.tx=t,this.ty=e,this.repaint()}translateX(t){this.ctx.translate(t,0),this.tx=t,this.repaint()}translateY(t){this.ctx.translate(0,t),this.ty=t,this.repaint()}_getWidth(){return this.canvas.width/this.ratio}_getHeight(){return this.canvas.height/this.ratio}_toCanvasX(t){return t/this.sc-this.tx}_toCanvasY(t){return t/this.sc-this.ty}_renderBg(){if(this.isRenderBg){let t=this.ctx;t.beginPath();let e=this.$canvas.width,i=this.$canvas.height,s=10;t.lineWidth=1;for(let a=.5;a<e;a+=s)t.moveTo(a,0),t.lineTo(a,i);for(let a=.5;a<i;a+=s)t.moveTo(0,a),t.lineTo(e,a);t.strokeStyle="#eee",t.stroke(),this.ctx.closePath()}}}var G={name:"root",props:["data"],cursor:"pointer",dragable:!0,data:{edges:[]},methods:{dependEdge(t){this.edges.push(t)}},beforeDestroy(){for(let t=this.edges.length-1;t>=0;t--){let e=this.$uae._nodeMap[this.edges[t]];e&&e.$destroy()}this.edges.length=0}},W={template:'<edge v-if="hasEdge" @handleEdgeSucc2="edgeSuccess" @handleEdgeDey2="edgeDestroy"></edge>',name:"anchor",props:["output","index"],cursor:"crosshair",link:!1,data:{isHover:!1,color:"#F69E9E",hasEdge:!1,edge:null},draw(){let t=this.ctx;t.beginPath(),t.arc(this.bounds.x+this.bounds.width,this.bounds.y,this.bounds.width,0,2*Math.PI),t.lineWidth=2,t.fillStyle="rgb(232, 247, 249)",t.fill(),t.strokeStyle=this.output.color,t.stroke(),t.closePath()},dragstart(t,e){this.hasEdge?this.edge=null:(this.hasEdge=!0,this.edge=this.$children[0],this.edge&&this.edge.handleDragStart(t,e))},drag(t,e){this.edge&&this.edge.handleDrag(t,e)},dragend(t,e){this.edge&&(this.hasEdge=this.edge.handleDragEnd(t,e),this.edge=null)},mounted(){if(this.connection){let t=this.connection.targetId,e=this.$uae.flowData.getDataById(t);this.hasEdge=!0;for(let t in this.$uae._nodeMap){let i=this.$uae._nodeMap[t];if(i.$block&&i.data===e){this.$children[0].endPoints=i.bounds,i.dependEdge(this.$children[0].$uid);break}}}},methods:{edgeSuccess(t){let e=this.$parent.data;Array.isArray(e.sourceConnections)||(e.sourceConnections=[]),e.sourceConnections.push({sourceTerminal:this.index,targetId:t.data.id,targetTerminal:"N"}),this.handleEdgeSucc({comp:t,output:this.output})},edgeDestroy(){let t=this.$parent.data;if(t.sourceConnections&&t.sourceConnections.length>0)for(let e=0;e<t.sourceConnections.length;e++){if(t.sourceConnections[e].sourceTerminal==this.index){t.sourceConnections.splice(e,1);break}}this.handleEdgeDey({output:this.output})}},computed:{connection:function(){let t=this.$parent.data.sourceConnections||[];for(let e=0;e<t.length;e++)if(t[e].sourceTerminal==this.output.value)return t[e]},bounds:function(){let t=this.$parent.data,e=this.$parent.bounds,i=parseInt(e.width/(t.output.length+1));return{x:e.x+i*(this.index+1)-4,y:e.y+e.height+1,width:4,height:4}}}};let K=new Image;K.src="data:image/png;base64,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";var U={template:'<anchor v-for="(item, index) in data.output" :output="item" :index="index" @handleEdgeSucc="handleEdgeSucc" @handleEdgeDey="handleEdgeDey"></anchor>',name:"step",mixin:"root",data:{lineWidth:4,hoverColor:"#C8D8FC",selectColor:"#C8D8FC",mainColor:"#367AA0",imgWidth:52,imgHeight:40,isHover:!1,isSelect:!1},draw(){let t=this.ctx,e=this.data,i=this.bounds;(this.isHover||this.isSelect)&&this.drawShape(this.hoverColor),this.ctx.beginPath(),this.ctx.drawImage(K,0,0,260,200,i.x+i.width/2-this.imgWidth/2,i.y+2,this.imgWidth,this.imgHeight);let s=this.data.desp;e.skip&&"1"===e.skip.enabled&&(this.mainColor="#909399"),t.strokeStyle=this.mainColor,t.lineWidth=this.lineWidth,t.roundRect(i.x,i.y+this.imgHeight,i.width,i.height-this.imgHeight,5),t.stroke(),t.fillStyle="#F5F7FA",t.fill();let a=.25*i.width-2;t.beginPath(),t.roundRect(i.x-2,i.y+this.imgHeight-2,a,i.height-this.imgHeight+4,5),t.fillStyle=this.mainColor,t.fill(),t.font="13px Arial",t.textAlign="center",t.textBaseline="middle",t.fillStyle="#FFF",t.fillText(e.id,i.x+a/2,i.y+12.5+this.imgHeight),t.textAlign="center",t.fillStyle="#000",t.fillText(s,i.x+.625*i.width,i.y+12.5+this.imgHeight,.75*i.width-2),this.ctx.closePath()},click(t){this.isSelect=t},hover(t){this.isHover=t},created(){this.data.bounds.width=160,this.data.bounds.height=25+this.imgHeight},methods:{handleEdgeDey(t){let{output:e}=t,i=this.data.output.indexOf(e);if(0===i)this.data.false=0;else if(1===i)this.data.true=0;else if(i>1&&Array.isArray(this.data.customOuts))for(let t=0;t<this.data.customOuts.length;t++)if(this.data.customOuts[t].startsWith(`${i}_`)){this.data.customOuts.splice(i,1);break}},handleEdgeSucc(t){let{comp:e,output:i}=t,s=this.data.output.indexOf(i);0===s?this.data.false=e.data.id:1===s?this.data.true=e.data.id:s>1&&(Array.isArray(this.data.customOuts)?this.data.customOuts.push(`${s}_${e.data.id}`):this.data.customOuts=[`${s}_${e.data.id}`])},drawShape(t){let e=this.bounds;this.ctx.beginPath(),this.ctx.strokeStyle=t,this.ctx.lineWidth=1.5,this.ctx.roundRect(e.x-4,e.y+15,e.width+8,e.height-8,5),this.ctx.fillStyle="#E9E9E9",this.ctx.stroke(),this.ctx.fill(),this.ctx.closePath()}},computed:{bounds:function(){return this.data.bounds}},watch:{"data.bounds.width":function(t){console.log("监听到 data.bounds.width 改变",t)}}},V={template:"<dragDot></dragDot>",name:"edge",block:!1,link:!1,dragable:!1,data:{start:{x:120,y:120,width:160,height:40},endPoints:{x:null,y:null},backUpEnd:null,isHover:!1,isSelect:!1},draw(){this.drawEdge(),(this.isSelect||this.isHover)&&this.drawShape()},isHere(t,e){let i=this.ctx;this.createPath();for(let s=-3;s<=3;s++){if(i.isPointInStroke(t+s,e))return!0;if(i.isPointInStroke(t,e+s))return!0}return!1},hover(t){this.isHover=t},click(t){this.isSelect=t},computed:{path(){this.start=this.$parent.bounds;let t=this.start.x+this.start.width/2+2,e=this.start.y+this.start.height;if(this.endPoints.width){return this.getToNodePath(t,e,this.start,this.endPoints)}if(this.endPoints.x){return this.getToPointPath(t,e,this.endPoints.x,this.endPoints.y,this.start)}}},beforeDestroy(){this.handleEdgeDey2(),this.$parent.hasEdge=!1},methods:{handleDragStart(t,e,i=!1){this.start=this.$parent.bounds,i&&(this.backUpEnd=this.endPoints),this.endPoints={x:t,y:e}},handleDrag(t,e){let i=this.$uae.getCompByPoint(t,e,t,e);i&&i.$link?this.endPoints=i.data.bounds:this.endPoints={x:t,y:e,width:null,height:null}},handleDragEnd(t,e){let i=this.$uae.getCompByPoint(t,e,t,e);return i&&i.$link?(this.handleEdgeSucc2(i),i.dependEdge(this.$uid),!0):(this.endPoints={x:t,y:e,width:null,height:null},this.$destroy(),!1)},handleDotDragEnd(t,e){let i=this.$uae.getCompByPoint(t,e,t,e);if(i&&i.$link)return this.handleEdgeDey2(),this.handleEdgeSucc2(i),i.dependEdge(this.$uid),!0;this.endPoints=this.backUpEnd},drawShape(){this.ctx.beginPath(),this.createPath();let t=this.ctx,e=this.$parent.output;t.lineWidth=8,t.strokeStyle="rgba(138, 209, 255, 0.3)",t.stroke(),t.lineWidth=2,t.strokeStyle=e.color,t.stroke(),this.ctx.closePath()},drawEdge(){let t=this.ctx,e=this.$parent.output;t.beginPath(),this.createPath(),t.lineWidth=2,t.strokeStyle=e.color,t.stroke(),this.createArrowPath(),t.fillStyle=e.color,t.fill()},createPath(){let t=this.ctx,e=this.path;if(!e||e.length<2)return;let i=e[0];t.lineWidth=12,t.beginPath(),t.moveTo(i.x,i.y);for(let i,s=1;s<e.length;s++){i=e[s];let a=0+i.x,h=i.y+0,n=e[s-1],o=0+n.x,l=0+n.y,r=e[s+1];if(r){let e=0+r.x,i=0+r.y,s=6;a!=o&&Math.abs(a-o)<12?s=Math.abs(a-o)/2:h!=l&&Math.abs(h-l)<12?s=Math.abs(h-l)/2:a!=e&&Math.abs(a-e)<12?s=Math.abs(a-e)/2:h!=i&&Math.abs(h-i)<12&&(s=Math.abs(h-i)/2),h>l?h-s>l&&t.lineTo(a,h-s):h<l?h+s<l&&t.lineTo(a,h+s):a>o?a-s>o&&t.lineTo(a-s,h):a>o&&a+s<o&&t.lineTo(a+s,h),t.arcTo(a,h,e,i,s)}else t.lineTo(a,h)}},createArrowPath(){let t=this.ctx,e=this.path;if(!e||e<2)return;t.beginPath();let i=e[e.length-2],s=i.x+0,a=i.y+0,h=e[e.length-1],n=h.x+0,o=h.y+0;n==s&&o>a?(t.moveTo(n-5,o-10),t.lineTo(n+5,o-10),t.lineTo(n,o+3),t.closePath()):n==s&&o<a?(t.moveTo(n-5,o+10),t.lineTo(n+5,o+10),t.lineTo(n,o-3),t.closePath()):o==a&&n>s?(t.moveTo(n-10,o+5),t.lineTo(n-10,o-5),t.lineTo(n+3,o),t.closePath()):o==a&&n<s?(t.moveTo(n+10,o+5),t.lineTo(n+10,o-5),t.lineTo(n-3,o),t.closePath()):(t.moveTo(n-5,o-10),t.lineTo(n+5,o-10),t.lineTo(n,o+3),t.closePath())},isIncluded(t,e,i,s){if(t>i){let e=t;t=i,i=e}if(e>s){let t=e;e=s,s=t}let a=this.path;for(let h,n=0;n<a.length;n++)if(h=a[n],h.x<t||h.x>i||h.y<e||h.y>s)return!1;return!0},getToNodePath(t,e,i,s){let a=s.x+parseInt(s.width/2),h=s.y,n=(t+a)/2,o=(e+h)/2,l=[];if(l.push({x:t,y:e}),h>e+15)l.push({x:t,y:o}),l.push({x:a,y:o});else{let o=i.x,r=i.x+i.width,d=s.x,c=s.x+s.width;o>c?n=(o+c)/2:r<d?n=(r+d)/2:n>o&&n<r&&(n=Math.abs(t-o)>Math.abs(t-r)-5?r+10:o-10),l.push({x:t,y:e+15}),l.push({x:n,y:e+15}),l.push({x:n,y:h-15}),l.push({x:a,y:h-15})}return l.push({x:a,y:h-4}),l},getToPointPath(t,e,i,s,a){let h=[];return h.push({x:t,y:e}),s<e+15?(h.push({x:t,y:e+15}),i<t+a.width/2+15&&i>a.x-15?i>t?(h.push({x:t+a.width/2+15,y:e+15}),h.push({x:t+a.width/2+15,y:s})):(h.push({x:a.x-15,y:e+15}),h.push({x:a.x-15,y:s})):h.push({x:i,y:e+15})):h.push({x:t,y:s}),h.push({x:i,y:s}),h}}},Z={name:"dragDot",cursor:"crosshair",block:!1,link:!1,data:{isHover:!1,isSelect:!1},draw(){let t=this.ctx;t.lineWidth=1,this.createPath(),this.$parent.isSelect&&this.drawColor(),this.isSelect&&this.drawColor(),t.closePath()},dragstart(t,e){this.$parent.handleDragStart(t,e,!0)},drag(t,e){this.$parent.handleDrag(t,e)},dragend(t,e){this.$parent.handleDotDragEnd(t,e)},methods:{createPath(){let t=this.ctx;t.beginPath(),this.bounds&&t.rect(this.bounds.x-4,this.bounds.y-8,this.bounds.width,this.bounds.height)},drawColor(){let t=this.ctx;t.fillStyle="#fff",t.fill(),t.strokeStyle="black",t.stroke()}},computed:{bounds:function(){let t=this.$parent.path;if(!t)return null;let e=t.slice(-1)[0];return{x:e.x,y:e.y,width:8,height:8}}},isHere(t,e){if(this.ctx.beginPath(),!this.bounds)return!1;this.createPath();for(let i=-1;i<=3;i++){if(this.ctx.isPointInPath(t+i,e))return!0;if(this.ctx.isPointInPath(t,e+i))return!0}return!1},hover(t){this.isHover=t},click(t){this.isSelect=t}},z={name:"selRect",link:!1,dragable:!1,block:!1,data:{x1:0,y1:0,x2:0,y2:0,isSelRect:!1},draw(){this.x1===this.x2&&this.y1===this.y2||(this.ctx.beginPath(),this.ctx.rect(this.x1,this.y1,this.x2-this.x1,this.y2-this.y1),this.ctx.fillStyle="rgba(100, 100, 100, .3)",this.ctx.fill(),this.ctx.lineWidth=.5,this.ctx.strokeStyle="rgba(100, 100, 100, .3)",this.ctx.stroke(),this.ctx.closePath())},methods:{handleDragStart(t,e){this.x1=t,this.y1=e,this.isSelRect=!0},handleDrag(t,e){this.isSelRect&&(this.x2=t,this.y2=e)},handleDragEnd(t,e){if(this.isSelRect){let t,e,i,s,a=this.$uae;this.x1>=this.x2?(e=this.x1,t=this.x2):(e=this.x2,t=this.x1),this.y1>=this.y2?(s=this.y1,i=this.y2):(s=this.y2,i=this.y1),a.getChildByRange(t,i,e,s).forEach((t=>{t.isSelect=!0}))}this.isSelRect=!1,this.x1=0,this.y1=0,this.x2=0,this.y2=0}}},q=[G,W,U,V,Z,z,{name:"common",mixin:"step",dblclick(t,e){let i=this.data;i.implementation?Array.isArray(i.implementation.node)||(i.implementation.node=[]):i.implementation={node:[]},this.$uae.drill.drillUae(i.implementation.node)},data:{mainColor:"#374E71"}},{name:"inSceneTrig",mixin:"step",data:{mainColor:"#0095FF"},dblclick(t){console.log("内部场景调用 双击")}},{name:"multOutput",mixin:"step",data:{mainColor:"#07B6B5"},dblclick(t){console.log("多出口 双击")}},{name:"normalEnd",mixin:"root",cursor:"pointer",dragable:!0,data:{lineWidth:4,mainColor:"#27C59A",hoverColor:"#C8D8FC",selectColor:"rgba(0, 144, 255, 0.5)",isHover:!1,isSelect:!1},draw(){this.isHover&&this.drawShape(this.hoverColor),this.isSelect&&this.drawShape(this.selectColor);let t=this.ctx,e=this.bounds;t.beginPath();let i={x:e.x+e.width/2,y:e.y+e.height/2,r:e.width/2};t.strokeStyle=this.mainColor,t.lineWidth=this.lineWidth,t.arc(i.x,i.y,i.r,0,2*Math.PI,!1),t.stroke();let s=t.createLinearGradient(e.x+i.r,e.y,e.x+i.r,e.y+2*i.r);s.addColorStop(0,this.mainColor),s.addColorStop(.25,this.mainColor),s.addColorStop(.25,"#FFF"),t.fillStyle=s,t.fill(),this.drawText(i)},click(t){this.isSelect=t},hover(t){this.isHover=t},created(){this.data.bounds.width=55,this.data.bounds.height=55},methods:{drawText(t){let e=this.ctx,i=this.bounds,s=this.data;e.fillStyle="#182932",e.font="12px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText("正常结束",i.x+t.r,i.y+t.r+3),e.fillStyle="#fff",e.fillText(s.id,i.x+t.r,i.y+.25*t.r),e.closePath()},drawShape(t){let e=this.ctx,i=this.bounds;e.beginPath(),e.lineWidth=2;let s={x:i.x+i.width/2,y:i.y+i.height/2,r:i.width/2};e.strokeStyle=t,e.arc(s.x,s.y,s.r+5,0,2*Math.PI,!1),e.stroke(),e.closePath()}},computed:{bounds:function(){return this.data.bounds}}},{template:'<anchor v-for="(item, index) in data.output" :output="item" :index="index"  @handleEdgeSucc="handleEdgeSucc" @handleEdgeDey="handleEdgeDey"></anchor>',name:"start",mixin:"normalEnd",link:!1,data:{mainColor:"#374E71"},methods:{handleEdgeDey(t){let{output:e}=t,i=this.data.output.indexOf(e);this.data.logic&&(delete this.data.logic[`ret${i}`],this.data.logic.total=Number(this.data.logic.total)-1)},handleEdgeSucc(t){let{comp:e,output:i}=t,s=this.data.output.indexOf(i);this.data.logic||(this.data.logic={}),this.data.logic.total=this.data.sourceConnections.length,this.data.logic[`ret${s}`]=e.data.id},drawText(t){let e=this.ctx,i=this.bounds,s=this.data;e.fillStyle="#182932",e.font="12px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText("开始",i.x+t.r,i.y+t.r+3),e.fillStyle="#fff",e.fillText(s.id,i.x+t.r,i.y+.25*t.r),e.closePath()}}},{name:"diyEnd",mixin:"normalEnd",data:{mainColor:"#7AA3CC"},methods:{drawText(t){let e=this.ctx,i=this.bounds,s=this.data,a=s.desp||"自定义结束";e.fillStyle="#182932",e.font="12px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText(a,i.x+t.r,i.y+t.r,i.width),e.fillStyle="#fff",e.fillText(s.id,i.x+t.r,i.y+.25*t.r),e.closePath()}}},{template:'<anchor v-for="(item, index) in data.output" :output="item" :index="index"  @handleEdgeSucc="handleEdgeSucc" @handleEdgeDey="handleEdgeDey"></anchor>',name:"transit",mixin:"normalEnd",data:{mainColor:"#0095FF"},methods:{handleEdgeDey(t){let{output:e}=t,i=this.data.output.indexOf(e);this.data.logic&&(delete this.data.logic[`ret${i}`],this.data.logic.total=Number(this.data.logic.total)-1)},handleEdgeSucc(t){let{comp:e,output:i}=t,s=this.data.output.indexOf(i);this.data.logic||(this.data.logic={}),this.data.logic.total=this.data.sourceConnections.length,this.data.logic[`ret${s}`]=e.data.id},drawText(t){let e=this.ctx,i=this.bounds,s=this.data;e.fillStyle="#182932",e.font="12px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText("中转节点",i.x+t.r,i.y+t.r+3),e.fillStyle="#fff",e.fillText(s.id,i.x+t.r,i.y+.25*t.r),e.closePath()}}},{template:'<anchor v-for="(item, index) in data.output" :output="item" :index="index" @handleEdgeSucc="handleEdgeSucc" @handleEdgeDey="handleEdgeDey"></anchor>\n                <risk v-if="data.risk"></risk>',name:"nodeScript",mixin:"root",data:{lineWidth:3,hoverColor:"#C8D8FC",selectColor:"rgba(0, 144, 255, 0.5)",mainColor:"#527292",isHover:!1,isSelect:!1,radius:2,icon:"\\ue7a2",leftWidth:36},draw(){this.isHover&&this.drawShape(this.hoverColor),this.isSelect&&this.drawShape(this.selectColor);let t=this.ctx,e=this.bounds,i=this.data;t.beginPath(),t.lineWidth=this.lineWidth,t.strokeStyle=this.mainColor,t.roundRect(e.x,e.y,e.width,e.height,this.radius),t.stroke(),t.fillStyle="#fff",t.fill(),t.closePath(),t.fillStyle="#333333",t.font="13px Arial",t.textAlign="center",t.textBaseline="middle",t.fillText(i.desp||"node",e.x+(e.width+this.leftWidth)/2,e.y+e.height/2,e.width-this.leftWidth-2),this.drawTrape(),this.drawIcon()},created(){this.data.bounds.width=160,this.data.bounds.height=25},computed:{bounds:function(){return this.data.bounds}},methods:{handleEdgeDey(t){let{output:e}=t,i=this.data.output.indexOf(e);this.data.logic&&(delete this.data.logic[`ret${i}`],this.data.logic.total=Number(this.data.logic.total)-1)},handleEdgeSucc(t){let{comp:e,output:i}=t,s=this.data.output.indexOf(i);this.data.logic||(this.data.logic={}),this.data.logic.total=this.data.sourceConnections.length,this.data.logic[`ret${s}`]=e.data.id},drawShape(t){let e=this.bounds,i=this.ctx;i.beginPath(),i.lineWidth=2,i.moveTo(e.x-4,e.y+2),i.lineTo(e.x+2,e.y-14),i.arcTo(e.x+4,e.y-18,e.x+8,e.y-18,4),i.lineTo(e.x+33,e.y-18),i.arcTo(e.x+34,e.y-18,e.x+37,e.y-12,4),i.lineTo(e.x+39,e.y-7),i.arcTo(e.x+40,e.y-4,e.x+44,e.y-4,4),i.lineTo(e.x+e.width-2,e.y-4),i.arcTo(e.x+e.width+4,e.y-4,e.x+e.width+4,e.y+4,4),i.lineTo(e.x+e.width+4,e.y+e.height-2),i.arcTo(e.x+e.width+4,e.y+e.height+4,e.x+e.width-4,e.y+e.height+4,4),i.lineTo(e.x+2,e.y+e.height+4),i.arcTo(e.x-4,e.y+e.height+4,e.x-4,e.y+e.height-2,4),i.closePath(),i.strokeStyle=t,i.stroke()},drawTrape(){let t=this.bounds,e=this.ctx,i=this.data,s=24,a=this.leftWidth,h=12,n=-2;e.beginPath(),e.moveTo(t.x+1,t.y+n),e.lineTo(t.x+1+(a-s)/2-2,t.y+n-h+2),e.arcTo(t.x+1+(a-s)/2,t.y+n-h,t.x+1+(a-s)/2+2,t.y+n-h,2),e.lineTo(t.x+1+(a+s)/2-2,t.y+n-h),e.arcTo(t.x+1+(a+s)/2,t.y+n-h,t.x+1+(a+s)/2+2,t.y+n-h+2,2),e.lineTo(t.x+1+a,t.y+n),e.closePath(),e.strokeStyle=this.mainColor,e.stroke(),e.fillStyle=this.mainColor,e.fill(),e.fillStyle="#FFFFFF",e.font="12px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText(i.id,t.x+a/2+1,t.y-6+n)},drawIcon(){let t=this.leftWidth,e=this.bounds,i=this.ctx;i.fillStyle=this.mainColor,i.font="20px iconfont",i.textAlign="center",i.textBaseline="middle",i.fillText("me",e.x+t/2,e.y+e.height/2),i.beginPath(),i.strokeStyle="#C8D0D4",i.lineWidth=2,i.moveTo(e.x+t,e.y+5),i.lineTo(e.x+t,e.y+e.height-5),i.stroke(),i.closePath()}},click(t){this.isSelect=t},hover(t){this.isHover=t}},{name:"defaultException",mixin:"nodeScript",data:{mainColor:"#374E71",icon:"\\ue7ad"}},{name:"risk",dragable:!1,link:!1,block:!1,data:{l1:{label:"微风险",color:"#0095FF"},l2:{label:"小风险",color:"#3E5DE4"},l3:{label:"中风险",color:"#FF872F"},l2:{label:"重风险",color:"#F65656"},space:4,r:4},draw(){let t=this.$parent.bounds,e=this.$parent.data;if(e.risk&&Number(e.risk)>0){let i=this.$parent.leftWidth,s=this.ctx,a=this[`l${e.risk}`],h={x:t.x+i-this.space-this.r,y:t.y+this.space+this.r,r:6};s.beginPath(),s.arc(h.x,h.y,h.r,0,2*Math.PI,!1),s.fillStyle=a.color,s.fill(),s.fillStyle="#527292",s.font="13px Arial",s.textAlign="center",s.textBaseline="middle",s.closePath()}},methods:{}},{name:"guideLine",dragable:!1,link:!1,block:!1,data:{guideX:[],guideY:[],mainColor:"rgba(0, 144, 255, 0.5)",diffVal:5},draw(){this.guideX.length>0&&this._drawVerticalLine(),this.guideY.length>0&&this._drawHorizontalLine()},methods:{_drawVerticalLine(){let t=this.ctx;for(let e,i=0;this.guideX.length,e=this.guideX[i];i++)t.moveTo(e,0-this.$uae.ty),t.lineTo(e,this.$uae._getHeight()-this.$uae.ty),t.strokeStyle=this.mainColor,t.lineWidth=2,t.stroke()},_drawHorizontalLine(){let t=this.ctx;for(let e,i=0;this.guideY.length,e=this.guideY[i];i++)t.moveTo(0-this.$uae.tx,e),t.lineTo(this.$uae._getWidth()-this.$uae.tx,e),t.strokeStyle=this.mainColor,t.lineWidth=2,t.stroke()},calcGuideLine(t){let e=this.$uae.selecteds,i=this.$uae.$children.filter((e=>e.$block&&e.id!==t.id));this.$uae.autoAdsorpt,this.clearGuideLine(),e.length>1||e.forEach((t=>{let e=this.$uae._nodeMap[t],s=e.bounds.x,a=e.bounds.x+e.bounds.width/2,h=e.bounds.x+e.bounds.width,n=e.bounds.y,o=e.bounds.y+e.bounds.height/2,l=e.bounds.y+e.bounds.height;i.forEach((t=>{let e=t.bounds.x,i=t.bounds.x+t.bounds.width/2,r=t.bounds.x+t.bounds.width,d=t.bounds.y,c=t.bounds.y+t.bounds.height/2,u=t.bounds.y+t.bounds.height;this.judgeLine(s,a,h,n,o,l,e,i,r,d,c,u)}))}))},judgeLine(t,e,i,s,a,h,n,o,l,r,d,c){e==n||e==o||e==l?this.guideX.push(e):t==n||t==o||t==l?this.guideX.push(t):i!=n&&i!=o&&i!=l||this.guideX.push(i),a==r||a==d||a==c?this.guideY.push(a):s==r||s==d||s==c?this.guideY.push(s):h!=r&&h!=d&&h!=c||this.guideY.push(h)},adsorpt(t,e,i,s,a,h,n,o,l,r,d,c){let u;return u=this.calDiff(e,n,o,l),null==u||Number.isNaN(u)?(u=this.calDiff(t,n,o,l),null==u||Number.isNaN(u)?(u=this.calDiff(i,n,o,l),null==u||Number.isNaN(u)?(u=this.calDiff(a,r,d,c),null==u||Number.isNaN(u)?(u=this.calDiff(s,r,d,c),null==u||Number.isNaN(u)?(u=this.calDiff(h,r,d,c),null==u||Number.isNaN(u)?void 0:(this.guideY.push(h),{y:u})):(this.guideY.push(s),{y:u})):(this.guideY.push(a),{y:u})):(this.guideX.push(i),{x:u})):(this.guideX.push(t),{x:u})):(this.guideX.push(e),{x:u})},calDiff(t,e,i,s){return Math.abs(t-e)<this.diffVal?t-e:Math.abs(t-i)<this.diffVal?t-i:Math.abs(t-s)<this.diffVal?t-s:void 0},clearGuideLine(){this.guideX.splice(0,this.guideX.length),this.guideY.splice(0,this.guideY.length)}}},{name:"abnormalEnd",mixin:"normalEnd",data:{mainColor:"#F65656"},methods:{drawText(t){let e=this.ctx,i=this.bounds,s=this.data;e.fillStyle="#182932",e.font="12px Arial",e.textAlign="center",e.textBaseline="middle",e.fillText("异常结束",i.x+t.r,i.y+t.r+3),e.fillStyle="#fff",e.fillText(s.id,i.x+t.r,i.y+.25*t.r),e.closePath()}}},{name:"return",link:!1,dragable:!1,block:!1,data:{text:"<=返回",color:"#3B3B3B"},draw(){let t=this.ctx;t.beginPath(),t.font="14px Arial",t.textAlign="left",t.textBaseline="middle",this.$uae.isNode,t.fillStyle=this.color,t.fillText(this.text,this.bounds.x,this.bounds.y),t.fill()},hover(t){this.color=t?"#5F8DFA":"#3B3B3B"},isHere(t,e){let i=this.ctx;return i.beginPath(),i.rect(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),!!i.isPointInPath(t,e)},computed:{bounds:function(){return{x:this.$uae.tx+10,y:this.$uae.ty+20,width:64,height:15}}}},{name:"dragMap",link:!1,dragable:!1,block:!1,data:{backColor:"rgba(100, 100, 100, .3)"},draw(){let t=this.ctx,e=this.bounds;t.beginPath(),t.lineWidth=2,t.rect(e.x,e.y,e.width,e.height),t.strokeStyle=this.backColor,t.fillStyle=this.backColor,t.stroke(),t.fill()},hover(t){t&&console.log("dragmap 被hover了！！")},isHere(t,e){let i=this.ctx;return i.beginPath(),i.rect(this.bounds.x,this.bounds.y,this.bounds.width,this.bounds.height),!!i.isPointInPath(t,e)},drag(){},computed:{bounds:function(){return{x:this.$uae.tx+10,y:this.$uae.ty+20,width:160,height:160}}}}],J={canvas:null,data:{isRenderBg:!1,isDrill:!1,autoAdsorpt:!1,isNode:!1,isBcpt:!1},created(){},dragstart(t){},drag(t){},dragend(t){},methods:{toggleBackground(t){this.isRenderBg=t,this.repaint()}}};class _{constructor(t,e,i){J.canvas=t,this.uae=new X({options:J}),this.uae.isNode=e,this.uae.isBcpt=i,this._init()}loopNodeList(t){this.uae.loopNodeList(t)}getNodeList(){return this.uae.$children.filter((t=>t.$block))}handleReadNode(t,e=!1){this.readyNode=t,this.isClick=e}handleCreateNode(t){return this.uae.createNode({type:t.nodeType,data:t},!0)}_init(){var t;(t=this).selRect=null,t.guideLine=null,t.events={},t.readyNode=null,t._toCanvasX=(...e)=>{t.uae._toCanvasX.apply(t.uae,e)},t._toCanvasY=(...e)=>{t.uae._toCanvasY.apply(t.uae,e)},function(t){for(let e=0;e<q.length;e++){let i=q[e];t.uae.registerComp(i)}}(this),function(t){t.selRect=t.uae.createNode({type:"selRect"}),t.guideLine=t.uae.createNode({type:"guideLine"}),t.returnBtu=t.uae.createNode({type:"return"}),t.dragMap=t.uae.createNode({type:"dragMap"})}(this),this._bind()}_bind(){this.uae.$on("dragstart",(t=>{this.handleDragStart(t)})),this.uae.$on("drag",(t=>{this.handleDrag(t)})),this.uae.$on("dragend",(t=>{this.handleDragEnd(t)})),this.uae.$on("click",(t=>{this.handleClick(t)})),this.uae.$on("dblclick",(t=>{})),this.uae.$on("keydown",(t=>{this.handleKeyDown(t)})),this.uae.$on("mouseenter",(t=>{this.handleMouseEnter(t)}))}handleDragStart(t){t.comp||this.selRect.handleDragStart(t.x,t.y)}handleDrag(t){t.comp?t.comp.$block&&t.comp.$link&&this.guideLine.calcGuideLine(t.comp):this.selRect.handleDrag(t.x,t.y)}handleDragEnd(t){this.selRect.handleDragEnd(t.x,t.y),this.guideLine.clearGuideLine(t.comp)}handleClick(t){t.comp&&(console.log("click comp",t.comp),this.trigger("click",t.comp))}handleMouseEnter(t){let e,i=t=>{this.isClick||e.drag&&e.drag(t.x,t.y)},s=t=>{this.uae.$off("mousemove",i),this.uae.$off("mouseup",s),this.isClick?(this.readyNode.bounds.x=t.x-60,this.readyNode.bounds.y=t.y-15,this.handleCreateNode(this.readyNode)):(console.log("end e.x, e.y",t.x,t.y),e.dragend&&e.dragend(t.x,t.x)),this.readyNode=null,this.isClick=null};this.readyNode&&this.isClick?this.uae.$on("mouseup",s):this.readyNode&&(this.readyNode.bounds.x=t.x,this.readyNode.bounds.y=t.y,e=this.handleCreateNode(this.readyNode),e.dragstart&&e.dragstart(t.x,t.y),this.uae.$on("mousemove",i),this.uae.$on("mouseup",s))}handleKeyDown(t){46===t.keyCode&&this.uae.deleteSelected()}on(t,e){"function"==typeof e&&(this.events||(this.events={}),this.events[t]||(this.events[t]=[]),this.events[t].push(e))}trigger(t,e){this.events&&this.events[t]&&this.events[t].forEach((t=>{"function"==typeof t&&t(e)}))}}export{_ as default};
